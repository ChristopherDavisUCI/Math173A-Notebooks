

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lab 2 - Math 173A &#8212; UC Irvine Math 173A, Summer Session I 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Lab2';</script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab 3 - Math 173A" href="Lab3.html" />
    <link rel="prev" title="Lab 1 - Math 173A" href="Lab1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/letterfreq.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/letterfreq.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    UC Irvine, Math 173A, Summer Session I 2023
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lab0.html">Lab 0 - Math 173A</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab1.html">Lab 1 - Math 173A</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 2 - Math 173A</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab3.html">Lab 3 - Math 173A</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab4.html">Lab 4 - Math 173A</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab5.html">Lab 5 - Math 173A</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Week1-Monday.html">Week 1 Monday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week1-Wednesday.html">Week 1 Wednesday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week1-Friday.html">Week 1 Friday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week2-Monday.html">Week 2 Monday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week2-Wednesday.html">Week 2 Wednesday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week2-Friday.html">Week 2 Friday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Z-KeyExchangeSpace.html">Key Exchange Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week3-Monday.html">Week 3 Monday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week3-Wednesday.html">Week 3 Wednesday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week3-Friday.html">Week 3 Friday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week4-Monday.html">Week 4 Monday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week4-Wednesday.html">Week 4 Wednesday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week4-Friday.html">Week 4 Friday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week5-Monday.html">Week 5 Monday</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week5-Wednesday.html">Week 5 Wednesday</a></li>
<li class="toctree-l1"><a class="reference internal" href="DifferenceSquares.html">Optional: Difference of Squares Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Week6-Monday.html">Week 6 Monday</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/ChristopherDavisUCI/Math173A-Notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Lab2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 2 - Math 173A</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suggestion">Suggestion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-for-diffie-hellman-key-exchange">Setup for Diffie-Hellman key exchange</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-a-smallish-prime">Finding a smallish prime</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-a-medium-prime">Finding a medium prime</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-a-diffie-hellman-key-exchange">Performing a Diffie-Hellman key exchange</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cliffhanger">Cliffhanger</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submission">Submission</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-2-math-173a">
<h1>Lab 2 - Math 173A<a class="headerlink" href="#lab-2-math-173a" title="Permalink to this headline">#</a></h1>
<p>You are encouraged to work in groups of up to 3 total students, but each student should make their own submission on Canvas.  (It’s fine for everyone in the group to have the same upload.)</p>
<p>Put the <strong>full names</strong> of everyone in your group (even if you’re working alone) here.  (This makes grading easier.)</p>
<ul class="simple">
<li><p><strong>Names</strong>:</p></li>
</ul>
<p>(You will also work together with another group below.  In particular, you will perform the Diffie-Hellman key exchange with another group.)</p>
<section id="suggestion">
<h2>Suggestion<a class="headerlink" href="#suggestion" title="Permalink to this headline">#</a></h2>
<p>Follow the instructions from the Lab 0 worksheet to make an Education Workspace for this lab.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Install the Python library <code class="docutils literal notranslate"><span class="pre">pycryptodome</span></code> by executing the following in a code cell.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install pycryptodome
</pre></div>
</div>
<p>Deepnote will suggest moving this to a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file.  Do that by clicking the “move packages” link that Deepnote shows.  Now every time you start the Deepnote hardware for this Lab 2 project, this package will be automatically installed and available to you.</p>
<p><strong>Comment 1</strong>.  One of the times I tried this, I couldn’t get the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file to be created.  If that happens to you, it’s not a big deal, you’ll just have to run the <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">pycryptodome</span></code> command each time you start the hardware.</p>
<p><strong>Comment 2</strong>.  We also need the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> library, but I believe that is pre-installed in Deepnote.  If it does not seem to be installed for you, then repeat the above procedure for <code class="docutils literal notranslate"><span class="pre">sympy</span></code> as well.</p>
<ul class="simple">
<li><p>Import some functions we will use by executing the following code.  (This will raise an error if  <code class="docutils literal notranslate"><span class="pre">pycryptodome</span></code> hasn’t been successfully installed.)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">getRandomNBitInteger</span>
<span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="kn">import</span> <span class="n">n_order</span>

<span class="kn">from</span> <span class="nn">Lab2_Helper</span> <span class="kn">import</span> <span class="p">(</span>
                            <span class="n">only_letters</span><span class="p">,</span>
                            <span class="n">weave</span><span class="p">,</span> 
                            <span class="n">shift_string</span><span class="p">,</span>
                            <span class="n">add_spaces</span><span class="p">,</span>
                            <span class="n">to_base_b</span><span class="p">,</span>
                            <span class="n">from_base_b</span>
                        <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Paste in your code defining the <code class="docutils literal notranslate"><span class="pre">vigenere</span></code> function from Lab 1.  (I believe I have included all the necessary imports like <code class="docutils literal notranslate"><span class="pre">only_letters</span></code>, but feel free to add more if your <code class="docutils literal notranslate"><span class="pre">vigenere</span></code> function depends on them.)</p></li>
</ul>
<ul class="simple">
<li><p>Paste in your code defining the <code class="docutils literal notranslate"><span class="pre">naive_dlog</span></code> function that you write as part of Homework 2, 4g.</p></li>
</ul>
<p><strong>Update 7/5/23</strong>: I realized my naive discrete logarithm function is a little more naive than I had intended.  In the implementation from the homework, we compute (for example) <code class="docutils literal notranslate"><span class="pre">pow(g,</span> <span class="pre">100000,</span> <span class="pre">p)</span></code> in one step, and then <code class="docutils literal notranslate"><span class="pre">pow(g,</span> <span class="pre">100001,</span> <span class="pre">p)</span></code> in the next step, and then <code class="docutils literal notranslate"><span class="pre">pow(g,</span> <span class="pre">100002,</span> <span class="pre">p)</span></code> in the next step, and so on.  The modular exponentiation function is fast, but it’s still a waste of computing power to compute the power “from scratch” each step.  Instead, we can use the fact that if we know <span class="math notranslate nohighlight">\(y := g^{100000} \bmod p\)</span> (for example), then we can simply compute <code class="docutils literal notranslate"><span class="pre">(g*y)%p</span></code> to find <span class="math notranslate nohighlight">\(g^{100001} \bmod p\)</span>, and so on.  For this lab, you can either use the code template from Homework 2, 4g, or you can adjust the algorithm to this “multiply the previous value by g and then reduce modulo p” algorithm that I just described.  The algorithm described here will be a little faster than the algorithm from Homework 2.</p>
</section>
<section id="setup-for-diffie-hellman-key-exchange">
<h2>Setup for Diffie-Hellman key exchange<a class="headerlink" href="#setup-for-diffie-hellman-key-exchange" title="Permalink to this headline">#</a></h2>
<section id="finding-a-smallish-prime">
<h3>Finding a smallish prime<a class="headerlink" href="#finding-a-smallish-prime" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">getPrime</span></code> function imported above takes as input an integer <code class="docutils literal notranslate"><span class="pre">N</span></code> and as output returns a random <code class="docutils literal notranslate"><span class="pre">N</span></code>-bit prime number.  (For example, <code class="docutils literal notranslate"><span class="pre">37</span> <span class="pre">=</span> <span class="pre">32</span> <span class="pre">+</span> <span class="pre">4</span> <span class="pre">+</span> <span class="pre">1</span></code> written in binary is <code class="docutils literal notranslate"><span class="pre">100101</span></code>, which is 6 digits, so <code class="docutils literal notranslate"><span class="pre">37</span></code> is a 6-bit prime number.  You can verify this by evaluating <code class="docutils literal notranslate"><span class="pre">to_base_b(37,</span> <span class="pre">2)</span></code> and checking that the resulting list is length 6.  The <code class="docutils literal notranslate"><span class="pre">from_base_b</span></code> function goes in the opposite direction.)</p>
<ul class="simple">
<li><p>Choose a prime <code class="docutils literal notranslate"><span class="pre">p0</span></code> using the <code class="docutils literal notranslate"><span class="pre">getPrime</span></code> function.  (See the next few instructions to help you decide how large the prime should be.)</p></li>
</ul>
<ul class="simple">
<li><p>Find a generator <code class="docutils literal notranslate"><span class="pre">g0</span></code> for <span class="math notranslate nohighlight">\((\mathbb{Z}/p_0\mathbb{Z})^\times\)</span>.  (Hint.  Use the <code class="docutils literal notranslate"><span class="pre">n_order</span></code> function that we imported from SymPy.  Call <code class="docutils literal notranslate"><span class="pre">help(n_order)</span></code> to see how this function works.  What order do we need to have a generator?  You will have to do some guessing-and-checking (or better, use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, calling <code class="docutils literal notranslate"><span class="pre">break</span></code> when you’ve found a generator), but it shouldn’t take many guesses before you find a generator.)</p></li>
</ul>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">naive_dlog(g0,</span> <span class="pre">0,</span> <span class="pre">p0)</span></code>, and time how long it takes using <code class="docutils literal notranslate"><span class="pre">%%time</span></code> at the top of the cell, as in Homework 2, Exercise 4.  We already know that no discrete logarithm exists in this case (why?), so the point of this is just to see how long the naive discrete logarithm takes to run in the worst-case scenario.</p></li>
</ul>
<ul class="simple">
<li><p>We want a prime for which this naive discrete logarithm calculation takes 1-4 seconds.  If your prime takes an amount of time outside of this range, then change the values of <code class="docutils literal notranslate"><span class="pre">p0</span></code> and <code class="docutils literal notranslate"><span class="pre">g0</span></code> above until you find values for which it takes 1-4 seconds.</p></li>
</ul>
</section>
<section id="finding-a-medium-prime">
<h3>Finding a medium prime<a class="headerlink" href="#finding-a-medium-prime" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Again using the getPrime function, find a prime <code class="docutils literal notranslate"><span class="pre">p</span></code> which is <code class="docutils literal notranslate"><span class="pre">20</span></code> bits larger (add, don’t multiply) than the prime <code class="docutils literal notranslate"><span class="pre">p0</span></code> you found above.</p></li>
</ul>
<ul class="simple">
<li><p>As above, find a generator <code class="docutils literal notranslate"><span class="pre">g</span></code> for <span class="math notranslate nohighlight">\((\mathbb{Z}/p\mathbb{Z})^{\times}\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>We estimate that multiplying <code class="docutils literal notranslate"><span class="pre">p0</span></code> by <code class="docutils literal notranslate"><span class="pre">M</span></code> will multiply the amount of time the naive discrete logarithm takes by <code class="docutils literal notranslate"><span class="pre">M</span></code>.  Using this estimate, how many <em>days</em> would you expect the naive discrete logarithm to take for <code class="docutils literal notranslate"><span class="pre">p</span></code>?  (Your answer should depend on <code class="docutils literal notranslate"><span class="pre">p/p0</span></code> and on the number of seconds given by your timing computation above.  <strong>Do not</strong> try to run the naive discrete logarithm function on <code class="docutils literal notranslate"><span class="pre">p</span></code> directly.  Be sure your answer is in days, not in seconds.)</p></li>
</ul>
</section>
</section>
<section id="performing-a-diffie-hellman-key-exchange">
<h2>Performing a Diffie-Hellman key exchange<a class="headerlink" href="#performing-a-diffie-hellman-key-exchange" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Find another student/group to work with (for example, post on Ed Discussion).  Put their names here.</p></li>
</ul>
<p><strong>Names for group 2</strong>:</p>
<ul class="simple">
<li><p>One of the two groups (“Alice”) should post the above values <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">g</span></code> on the “Lab 2 Key Exchanges” thread on Ed Discussion.</p></li>
</ul>
<ul class="simple">
<li><p>Alice and Bob should choose random secret exponents <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> (respectively).  To find <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, use the <code class="docutils literal notranslate"><span class="pre">getRandomNBitInteger</span></code> function we imported above, calling <code class="docutils literal notranslate"><span class="pre">getRandomNBitInteger(N)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is 1 or 2 less than the number of bits of <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
</ul>
<p>(Homework 2, question 6b, asks why it is not secure to choose a secret exponent like <code class="docutils literal notranslate"><span class="pre">500000</span></code>.)</p>
<ul class="simple">
<li><p>Alice and Bob should then compute <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> (using <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, respectively), in the notation of Hoffstein, Pipher, Silverman, Section 2.2, using the <code class="docutils literal notranslate"><span class="pre">pow</span></code> function (the three-argument version).  Alice and Bob should post these public values <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> on Ed Discussion (as replies to the message posting <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">g</span></code>).</p></li>
</ul>
<p>Be sure that <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> never get posted (nor exchanged between Alice and Bob), but you probably want to display your secret exponent in this notebook so you still have access to it if the hardware resets.</p>
<ul class="simple">
<li><p>Alice and Bob should both (independently) compute their shared secret key <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
</ul>
<ul class="simple">
<li><p>Alice and Bob should both (independently) convert <code class="docutils literal notranslate"><span class="pre">k</span></code> to a list of digits from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">25</span></code> (inclusive) using the imported <code class="docutils literal notranslate"><span class="pre">to_base_b</span></code> function.  Name the resulting list <code class="docutils literal notranslate"><span class="pre">vig_key</span></code>.  This list <code class="docutils literal notranslate"><span class="pre">vig_key</span></code> will be the shared private key for a <code class="docutils literal notranslate"><span class="pre">Vigenere</span></code> cipher.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vig_key</span> <span class="o">=</span> <span class="n">to_base_b</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Bob should choose a secret message <code class="docutils literal notranslate"><span class="pre">M</span></code> that he wishes to send to Alice.  (It does not have to be a long message, not nearly as long as the messages in Lab 1.  We don’t want the Vigenère ciphertext to be vulnerable to decryption using frequency analysis.)</p></li>
</ul>
<ul class="simple">
<li><p>With the <code class="docutils literal notranslate"><span class="pre">vigenere</span></code> function, Bob should encrypt his secret message <code class="docutils literal notranslate"><span class="pre">M</span></code> using the list <code class="docutils literal notranslate"><span class="pre">vig_key</span></code> computed above, as in the following code.  Bob should post this encrypted message <code class="docutils literal notranslate"><span class="pre">Y</span></code> as a reply on the same thread.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">vigenere</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">vig_key</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">add_spaces</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Alice should take this public message <code class="docutils literal notranslate"><span class="pre">Y</span></code> and decrypt it.  Notice that the list <code class="docutils literal notranslate"><span class="pre">vig_key</span></code> was used for encryption, so a slightly different list should be used for decryption.  (What shift amounts do the decryption, in terms of the encryption shift amounts?)</p></li>
</ul>
<p>Here we are defining the decryption key <code class="docutils literal notranslate"><span class="pre">decrypt_key</span></code> using a list creation method in Python called “list comprehension”; be sure to ask if the syntax is confusing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>decrypt_key = [??? for x in vig_key]
M = vigenere(Y, decrypt_key)
M
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Do not</strong> post the decrypted plaintext in the thread.  Alice and Bob should not exchange any information in private.  The public information (which is the same as the information shared between Alice and Bob) should be <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p></li>
<li><p>If Alice has successfully decrypted the message (meaning she gets something that is English), then you are done with this lab.</p></li>
</ul>
</section>
<section id="cliffhanger">
<h2>Cliffhanger<a class="headerlink" href="#cliffhanger" title="Permalink to this headline">#</a></h2>
<p>We chose our prime <code class="docutils literal notranslate"><span class="pre">p</span></code> above so that the discrete logarithm is not computable in a reasonable amount of time using the naive algorithm.</p>
<p>Thus the exchanged message is secure…</p>
<p><img alt="Mr Burns evil smile" src="_images/mr_burns.jpg" /></p>
</section>
<section id="submission">
<h2>Submission<a class="headerlink" href="#submission" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">Share</span></code> button at the top right, enable public sharing, and enable Comment privileges. Then submit the created link on Canvas.</p></li>
</ul>
<p>(Don’t just copy the browser URL.  Copy the link that is provided after you click the “Share” button.  It won’t be available until you enable public sharing.)</p>
<ul class="simple">
<li><p>Reminder: Everyone in the group needs to submit this link on Canvas.</p></li>
</ul>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=a90216b8-8f1e-4503-9479-61ebe9574770' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Lab1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 1 - Math 173A</p>
      </div>
    </a>
    <a class="right-next"
       href="Lab3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 3 - Math 173A</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suggestion">Suggestion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-for-diffie-hellman-key-exchange">Setup for Diffie-Hellman key exchange</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-a-smallish-prime">Finding a smallish prime</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-a-medium-prime">Finding a medium prime</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-a-diffie-hellman-key-exchange">Performing a Diffie-Hellman key exchange</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cliffhanger">Cliffhanger</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submission">Submission</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christopher Davis
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>